<html>
  <head>
    <title></title>
    <meta content="">
    <link rel="stylesheet" media="screen" href="https://fontlibrary.org/face/elaine-sans" type="text/css"/> 
    <link rel="stylesheet" type="text/css" media="screen" href="main.css" />

    <script src="step.js"></script>
    <script src="step1.js"></script>
    <script src="step2.js"></script>
    <script src="step3.js"></script>
    <script src="step4.js"></script>
    <script src="step5.js"></script>
    <script src="step6.js"></script>
    <script src="step7.js"></script>
    <script src="step8.js"></script>

  </head>
  <body>
      <header class="top">
        <h1 class="top__main-title">RandoLiveTiles</h1>
        <form>
            <label for="rando">Nom de la rando:</label>
            <input type="text" name="rando-name" id="rando" value="Le Grand Galibier"/>
            
            <label for="date1">Date début:</label>
            <input id="date1" type="date"/>
            <label for="date1">Date fin:</label> 
            <input id="date2" type="date"/> 
            <br/>
            <input type="button" value="Démmarer" onclick="start()"/> 
          </form>
      </header>
      <main>
          <section>
            <article class="application" id="app1">
                <header class="application__description">
                    <h2 class="application__title">Service 1</h2>
                    <a href="https://github.com/ppsfleet/randolivetiles">https://github.com/ppsfleet/randolivetiles</a>
                </header>
                 <!--------- Route /RANDO ----------->
                  <div class="route">
                    <header class="route__top">
                      <h3 class="route__title"><span class="route__verbe">GET</span> <span class="route__server">127.0.0.1:12401</span>/rando/:nom</h3>
                      <div class="route__description">Récupére le texte de la randonnée demandée</div>
                    </header>
                    
                    <div class="route__content">
                      <!--------- input ----------->
                      <div class="route__input">
                        <div class="route__subtitle">Entrée</div>
                          - Paramètre URL:
                          <pre>nom : nom de la randonnée</pre>
                        </ul>
                      </div>
                      <!--------- output ---------->
                      <div class="route__output">
                          <div class="route__subtitle">Sortie</div>
                          <pre>[description des randonnées trouvées]</pre>
                      </div>
                      <!--------- exemple --------->
                      <div class="route__exemple">
                          <div class="route__subtitle">Exemple</div>
                          <div id="app1-exemple"></div>
                      </div>
                    </div>
                  </div>
            </article>

<!-- 2 --------------------------------------------------------------------------------------------------------------------------------->

            <article class="application" id="app2">
                <header class="application__description">
                    <h2 class="application__title">Service 2</h2>
                    <a href="https://github.com/ppsfleet/randolivetiles">https://github.com/ppsfleet/randolivetiles</a>
                </header>
                <!--------- Route /textannotation ----------->
                <div class="route">
                  <header class="route__top">
                    <h3 class="route__title"><span class="route__verbe">POST</span> <span class="route__server">127.0.0.1:12401</span>/textannotation</h3>
                    <div class="route__description">Extrait les entités sémantiques (ENS) du texte passé en paramètre</div>
                  </header>
                  
                  <div class="route__content">
                    <!--------- input ----------->
                    <div class="route__input">
                      <div class="route__subtitle">Entrée</div>
                        - Paramètre POST:
                        <pre>text : description de la randonnée</pre>
                      </ul>
                    </div>
                    <!--------- output ---------->
                    <div class="route__output">
                        <div class="route__subtitle">Sortie</div>
                        <pre>[  "ENS1","ENS2",...]</pre>
                    </div>
                    <!--------- exemple --------->
                    <div class="route__exemple" >
                        <div class="route__subtitle">Exemple</div>
                        <div id="app2-exemple">

                        </div>
                    </div>
                  </div>
                </div>
            </article>

<!-- 3 --------------------------------------------------------------------------------------------------------------------------------->

            <article class="application" id="app3">
                <header class="application__description">
                    <h2 class="application__title">Service 3</h2>
                    <a href="https://github.com/ppsfleet/randolivetiles">https://github.com/ppsfleet/randolivetiles</a>
                </header>
                <!--------- Route /locateentities ----------->
                <div class="route">
                    <header class="route__top">
                      <h3 class="route__title"><span class="route__verbe">POST</span> <span class="route__server">127.0.0.1:12401</span>/locateentities</h3>
                      <div class="route__description">Géolocalise les ENS passées en paramètre</div>
                    </header>
                    
                    <div class="route__content">
                      <!--------- input ----------->
                      <div class="route__input">
                        <div class="route__subtitle">Entrée</div>
                          - Paramètre POST:
                          <pre>places : [place1,place2,...]</pre>
                        </ul>
                      </div>
                      <!--------- output ---------->
                      <div class="route__output">
                          <div class="route__subtitle">Sortie</div>
                          <pre>[  "géolocalisation1","géolocalisation2",...]</pre>
                      </div>
                      <!--------- exemple --------->
                      <div class="route__exemple">
                          <div class="route__subtitle">Exemple</div>
                          <div id="app3-exemple"></div>
                      </div>
                    </div>
                  </div>
            </article>

<!-- 4 --------------------------------------------------------------------------------------------------------------------------------->

            <article class="application" id="app4">
                <header class="application__description">
                    <h2 class="application__title">Service 4</h2>
                    <a href="https://github.com/ppsfleet/randolivetiles">https://github.com/ppsfleet/randolivetiles</a>
                </header>
                <!--------- Route /randolivetiles ----------->
                <div class="route">
                  <header class="route__top">
                    <h3 class="route__title"><span class="route__verbe">POST</span> <span class="route__server">127.0.0.1:12401</span>/mainUTM</h3>
                    <div class="route__description">Calcul la zone géographique (Geobox) des géolocalisations passées en paramètre</div>
                  </header>
                  
                  <div class="route__content">
                    <!--------- input ----------->
                    <div class="route__input">
                      <div class="route__subtitle">Entrée</div>
                        - Paramètre POST:
                        <pre>geolocs:[  "géolocalisation1","géolocalisation2",...]</pre>
                      </ul>
                    </div>
                    <!--------- output ---------->
                    <div class="route__output">
                        <div class="route__subtitle">Sortie</div>
                        <pre>[  "coordonée1","coordonée2","coordonée3","coordonée4"]</pre>
                    </div>
                    <!--------- exemple --------->
                    <div class="route__exemple">
                        <div class="route__subtitle">Exemple</div>
                        <div id="app4-exemple"></div>
                    </div>
                  </div>
                </div>
            </article>

<!-- 5 ------------------------------------------------------------------------------------------------------------------------------->

            <article class="application" id="app5">
                <header class="application__description">
                    <h2 class="application__title">Service 5</h2>
                    <a href="https://github.com/ppsfleet/randolivetiles">https://github.com/ppsfleet/randolivetiles</a>
                </header>
                <!--------- Route /satelliteimage ----------->
                <div class="route">
                  <header class="route__top">
                    <h3 class="route__title"><span class="route__verbe">GET</span> <span class="route__server">127.0.0.1:12401</span>/satelliteimage/:zone</h3>
                    <div class="route__description">Récupére une liste d’images satellites sentinelle 2 dans la zone geobox et l'intervalle de date demandés</div>
                  </header>
                  
                  <div class="route__content">
                    <!--------- input ----------->
                    <div class="route__input">
                      <div class="route__subtitle">Entrée</div>
                        - Paramètre URL:
                        <pre>zone: coordonée1,coordonée2,coordonée3,coordonée4</pre>
                        - Paramètre GET:
                        <pre>dateBegin: date debut de recherche d'image au format iso 8601</pre>
                        <pre>dateEnd: date fin de recherche d'image au format iso 8601</pre>
                      </ul>
                    </div>
                    <!--------- output ---------->
                    <div class="route__output">
                        <div class="route__subtitle">Sortie</div>
                        <pre>{"img":[{"location":...,"projection":...,"url":...,"cloudCover":...,"date":...,"level":...},{...},...]</pre>
                    </div>
                    <!--------- exemple --------->
                    <div class="route__exemple">
                        <div class="route__subtitle">Exemple</div>
                        <div id="app5-exemple"></div>
                    </div>
                  </div>
                </div>
            </article>

<!-- 6 ------------------------------------------------------------------------------------------------------------------------------->

            <article class="application" id="app6">
                <header class="application__description">
                    <h2 class="application__title">Service 6</h2>
                    <a href="https://github.com/ppsfleet/satiles">https://github.com/ppsfleet/satiles</a>
                </header>
                 <!--------- Route / ----------->
                 <div class="route">
                  <header class="route__top">
                    <h3 class="route__title"><span class="route__verbe">POST</span> <span class="route__server">127.0.0.1:12403</span>/</h3>
                    <div class="route__description">Tuile une image satellite avec GDAL2TILES</div>
                  </header>
                  
                  <div class="route__content">
                    <!--------- input ----------->
                    <div class="route__input">
                      <div class="route__subtitle">Entrée</div>
                        - Paramètre POST:
                        <pre>url: url de l'image</pre>
                      </ul>
                    </div>
                    <!--------- output ---------->
                    <div class="route__output">
                        <div class="route__subtitle">Sortie</div>
                        <pre>/path/to/img/dir/07ddd0cf-defa-53e8-ac34-c8a1b3e8cb7c</pre>
                    </div>
                    <!--------- exemple --------->
                    <div class="route__exemple">
                        <div class="route__subtitle">Exemple</div>
                        <div id="app6-exemple"></div>
                    </div>
                  </div>
                </div>

                <!--------- Route / ----------->
                <div class="route">
                  <header class="route__top">
                    <h3 class="route__title"><span class="route__verbe">GET</span> <span class="route__server">127.0.0.1:12403</span>/check-img-status</h3>
                    <div class="route__description">Verifie si le tuilage est terminé</div>
                  </header>
                  
                  <div class="route__content">
                    <!--------- input ----------->
                    <div class="route__input">
                      <div class="route__subtitle">Entrée</div>
                        - Paramètre GET:
                        <pre>img: nom de l'image</pre>
                      </ul>
                    </div>
                    <!--------- output ---------->
                    <div class="route__output">
                        <div class="route__subtitle">Sortie</div>
                        <pre>true ou false</pre>
                    </div>
                    <!--------- exemple --------->
                    <div class="route__exemple">
                        <div class="route__subtitle">Exemple</div>
                        <div id="app6-exemple2"></div>
                    </div>
                  </div>
                </div>
            </article>

<!-- 7 -------------------------------------------------------------------------------------------------------------------------------->

            <article class="application" id="app7">
                <header class="application__description">
                    <h2 class="application__title">Service 7</h2>
                    <a href="https://github.com/ppsfleet/randolivetiles">https://github.com/ppsfleet/hdfsup</a>
                </header>
                <!--------- Route ----------->
                <div class="route">
                  <header class="route__top">
                    <h3 class="route__title"><span class="route__verbe">GET</span> <span class="route__server">127.0.0.1:12402</span>/file</h3>
                    <div class="route__description">Demmare l'upload de fichier vers hdfs et renvoie l'id du processus en cours</div>
                  </header>
                  
                  <div class="route__content">
                    <!--------- input ----------->
                    <div class="route__input">
                      <div class="route__subtitle">Entrée</div>
                        - Paramètre GET:
                        <pre>path : url du fichier en local</pre>
                      </ul>
                    </div>
                    <!--------- output ---------->
                    <div class="route__output">
                        <div class="route__subtitle">Sortie</div>
                        <pre>id</pre>
                    </div>
                    <!--------- exemple --------->
                    <div class="route__exemple">
                        <div class="route__subtitle">Exemple</div>
                        <div id="app7-exemple"></div>
                    </div>
                  </div>
                </div>
                <!--------- Route ----------->
                <div class="route">
                  <header class="route__top">
                      <h3 class="route__title"><span class="route__verbe">GET</span> <span class="route__server">127.0.0.1:12402</span>/status</h3>
                      <div class="route__description">Renvoie le status du processus avec l'id demandé</div>
                  </header>
                  <div class="route__content">
                    <!--------- input ----------->
                    <div class="route__input">
                        <div class="route__subtitle">Entrée</div>
                        - Paramètre GET:
                        <pre>pid : id du processus</pre>
                    </div>
                    <!--------- output ---------->
                    <div class="route__output">
                        <div class="route__subtitle">Sortie</div>
                        <pre>
{
  "cmd": "scp ou hadoop",
  "running": 1 ou 0,
  "error": 1 ou 0
}
                        </pre>
                    </div>
                    <!--------- exemple --------->
                    <div class="route__exemple">
                        <div class="route__subtitle">Exemple</div>
                        <div id="app7-exemple2"></div>
                    </div>
                  </div>
                </div>
            </article>

<!-- 8 -------------------------------------------------------------------------------------------------------------------------------->

            <article class="application" id="app8">
                <header class="application__description">
                    <h2 class="application__title">Service 8</h2>
                    <a href="https://github.com/ppsfleet/randolivetiles">https://github.com/ppsfleet/randolivetiles</a>
                </header>
                <div class="route">
                  <header class="route__top">
                    <h3 class="route__title"><span class="route__verbe">POST</span> <span class="route__server">127.0.0.1:12401</span>http://127.0.0.1:12401/indexelastic/</h3>
                    <div class="route__description">Insére les meta-données de l’image dans un elastic search</div>
                  </header>
                  
                  <div class="route__content">
                    <!--------- input ----------->
                    <div class="route__input">
                      <div class="route__subtitle">Entrée</div>
                        - Paramètre POST:
                        <pre>{"location":...,"projection":...,"url":...,"cloudCover":...,"date":...,"level":...,"url":path_hdfs}</pre>
                      </ul>
                    </div>
                    <!--------- output ---------->
                    <div class="route__output">
                        <div class="route__subtitle">Sortie</div>
                        <pre>/path/to/img/dir/07ddd0cf-defa-53e8-ac34-c8a1b3e8cb7c</pre>
                    </div>
                    <!--------- exemple --------->
                    <div class="route__exemple">
                        <div class="route__subtitle">Exemple</div>
                        <div id="app8-exemple"></div>
                    </div>
                  </div>
                </div>
            </article>

<!-- 9 -------------------------------------------------------------------------------------------------------------------------------->

            <article class="application" id="app9">
                <header class="application__description">
                    <h2 class="application__title">Service 9</h2>
                    <a href="https://github.com/ppsfleet/randolivetiles">https://github.com/ppsfleet/randolivetiles</a>
                </header>
            </article>
          </section>
      </main>
      <script>
        let st1 = new Step1([document.getElementById("app1-exemple")],document.getElementById("app1"))
        let st2 = new Step2([document.getElementById("app2-exemple")],document.getElementById("app2"))
        let st3 = new Step3([document.getElementById("app3-exemple")],document.getElementById("app3"))
        let st4 = new Step4([document.getElementById("app4-exemple")],document.getElementById("app4"))
        let st5 = new Step5([document.getElementById("app5-exemple")],document.getElementById("app5"))
        let st6 = new Step6([
            document.getElementById("app6-exemple"),
            document.getElementById("app6-exemple2")],
            document.getElementById("app6"))
        let st7 = new Step7([
            document.getElementById("app7-exemple"),
            document.getElementById("app7-exemple2")],
            document.getElementById("app7"))
        let st8 = new Step8([document.getElementById("app8-exemple")],document.getElementById("app8"))
        
        
        st1.addCallback((e) => {st2.start(e)})
        st2.addCallback((e) => {st3.start(e)})
        st3.addCallback((e) => {st4.start(e)})
        st4.addCallback((e) => {
          d1 = new Date(Date.parse(document.getElementById("date1").value)).toISOString();;
          d2 = new Date(Date.parse(document.getElementById("date2").value)).toISOString();;
          st5.start(e,d1,d2)
        })
        st5.addCallback((e) => {st6.start(e)})
        st6.addCallback((e) => {st7.start(e)})
        st7.addCallback((e) => {st8.start(e)})


        function start()
        {
          st1.start(document.getElementById("rando").value)
        }
        window.onload = function(){
                var acc = document.getElementsByClassName("route__top");
                for (let i = 0; i < acc.length; i++) {
                  acc[i].addEventListener("click", function() {
                  /* Toggle between adding and removing the "active" class,
                  to highlight the button that controls the panel */
                    this.classList.toggle("active");
                    var panel = this.nextElementSibling;
                    if (panel.style.maxHeight){
                      panel.style.maxHeight = null;
                    } else {
                      panel.style.maxHeight = panel.scrollHeight + "px";
                    } 
                  })
                }
        }         
      </script>
  </body>
</html>
